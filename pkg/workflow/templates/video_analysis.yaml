name: video_analysis
description: 视频分析 - Video analysis pipeline with frame extraction and understanding

config:
  frame_interval: 30
  vlm_model: "llava"
  llm_model: "llama3.2"

steps:
  - id: extract_frames
    type: resource.extract_frames
    input:
      video: "${input.video}"
      interval: "${config.frame_interval}"
  
  - id: analyze_frames
    type: inference.batch_describe
    input:
      model: "${config.vlm_model}"
      images: "${steps.extract_frames.frames}"
    depends_on:
      - extract_frames
  
  - id: summarize
    type: inference.chat
    input:
      model: "${config.llm_model}"
      messages:
        - role: system
          content: "总结视频内容"
        - role: user
          content: "帧分析结果: ${steps.analyze_frames.descriptions}"
    depends_on:
      - analyze_frames

output:
  summary: "${steps.summarize.response.content}"
